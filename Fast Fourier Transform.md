##[Fast Fourier Transform](https://en.wikipedia.org/wiki/Fast_Fourier_transform)
 - 正如同我在[README](https://github.com/chenhsishen/Pulse-Wave-Analysis/blob/master/README.md)提到的，傅立葉轉換能夠幫助我們找出一段波中主要的頻率，，再藉由這個頻率，回推主要波形的週期；而「快速」傅立葉轉換，好像又比較厲害一點。
 - 關於詳細的數學內容，我不會著墨太多，主要的原因是，其實我也不是很在行；但工具就是這樣，deadline在即，用的好比較重要。詳細的數學可以在各個地方找到。
 - 至今仍有小小的bug，我用暴力的方式克服它，會在下面的程式看到；也要感謝摯友李唐和冠麟的協助，帶我認識這個演算法。

---

###所謂「快速」傅立葉轉換
 - 傅立葉轉換，簡而言之，透過堆疊各種振幅和週期相異的、波形相對簡單的波(例如SIN波)，去逼近真實的波段的振幅和週期；再藉由這樣的轉換，把波的資料從時間的維度上轉換到頻率的維度，能逼近真實的頻率。
 - 然而，傅立葉轉換需要大量的數學運算，會消耗許多的資源(時間);因此，「快速」傅立葉轉換就誕生啦！藉著稀疏(Sparse，就矩陣裡面的元素很多都是零)的方法，去降低需要運算的次數，進而提升效率。
 - 現在的傅立葉轉換，通常都會藉由快速傅立葉轉換來幫我們完成需要的運算。
 
###Fast Fourier Transform in R
 - 真紅的演算法(是真紅演算法，不是真紅眼黑龍)，在各種開源專案中當然都能見到它的蹤跡。R當然也不例外，透過內建的```fft()```函數，簡單兩行程式就可以直觀地完成。
  
```R
 f <- fft(raw[,2])  #對原始資料做轉換
 ff <- Re(f)^2     #轉換後的數包含了正負號和虛數，因此我們取出實數並將其做平方
```
  
 - 如果把得到的數列畫出來(記得去掉第一個數)，會得到下面這張圖：
 
 ![Imgur](http://i.imgur.com/uO23FJi.png)
 
 - 如果放很大來看，你會看一根一根的東西，那根東西越高，代表那是越主要的頻率；基本上看左邊的那一撮，最高的那根對應到的橫軸(即頻率的維度)，就是主要的頻率。

###Turn Frequency-domain back to Time-domain
 - 我們最重要的任務是要擷取出波段，所以需要知道頻率，並轉換回週期
 - 在這邊我遇到了一點問題，所以我在計算週期時做了一些處理，我把資料以時間維度20000做區分，去找出主要的頻率。
 - 詳細的原因一直沒有再去debug，若是有新的發現，會再更新上來。

```R
  index_1 <- c()
  index_1 <- ifelse(length(raw[,2])<=20000, index_1 <-length(raw[,2])/c(which(ff_1 %in% max(ff_1[2:50]))+1),
                    index_1 <-length(raw[,2])/c(which(ff_1 %in% max(ff_1[2:100]))+1))     
                    
```
 - 一個簡單的細節：if的迴圈對於R而言，使用```ifelse()```的效率會比一般if迴圈快上非常非常多。

###透過簡單的幾行程式，成功掌握「單個脈波」的週期；雖然每個脈波的週期有所不同，但這個資訊已經足夠我們進行下一步 - 找local minimum。
